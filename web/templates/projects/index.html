
{% extends 'base_app.html' %}
{% load unicorn %}

{% block title %}
Projects
{% endblock %}

{% block title_button %}
<div class="flex">
  <form action="{% url 'project_export_csv' %}" method="POST">
    {% csrf_token %}
    <button type="submit" name='import_csv' class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-teal-600 border border-transparent rounded-md shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-teal-800 focus:ring-teal-500">
      Download csv
    </button>
  </form>
  <div class="ml-4" x-data="{open: false}">
    <div x-on:open-import-modal="open=true; console.log('open-import-modal')">
      <button type="button" class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-teal-600 border border-transparent rounded-md shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-teal-800 focus:ring-teal-500" x-on:click="$dispatch('open-import-modal');">
        Upload csv
      </button>
      {% include 'projects/project_import_modal.html'%}
    </div>
  </div>

</div>
{% endblock title_button %}

{% block body %}
<div class="flex flex-col">
  <div class="-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
    <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
      <div class="overflow-hidden border-b border-gray-200 shadow sm:rounded-lg">
        <table class="divide-y divide-gray-200 table-fixed">
          <thead class="bg-gray-50">
            <tr>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Project
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Budget
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Providers
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Deadline
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Laravel
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Status
              </th>
              <th scope="col" class="w-1/3 px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase">
                Comments
              </th>
              <th scope="col" class="relative w-1/3 px-6 py-3">
                <span class="sr-only">Actions</span>
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for project in projects %}
            <tr>
              <td class="px-6 py-4">
                <div class="text-sm text-gray-900">
                <a href="{{project.link}}" class="text-teal-600 hover:text-teal-900">
                {{ project.name }}
                </a>
                </div>
                <div class="text-sm text-gray-500">{{ project.code }}</div>
              </td>
              <td class="px-6 py-4 text-sm text-gray-500 ">
                {{ project.budget }}
              </td>
              <td class="px-6 py-4 text-sm text-gray-500 ">
                {{ project.providers }}
              </td>
              <td class="w-20 px-6 py-4 text-sm text-gray-500">
                {{ project.deadline | date:'d-m-Y' }}
              </td>
              <td class="px-6 py-4 ">
                <span class="inline-flex px-2 text-xs font-semibold leading-5 rounded-full {% if project.laravel %}text-green-800 bg-green-100 {% else %} text-red-800 bg-red-100 {% endif %}">
                  {{ project.laravel }}
                </span>
              </td>

              <td class="px-6 py-4 ">
                <span class="inline-flex px-2 text-xs font-semibold leading-5 rounded-full
                {% if project.last_status.status == 1 or project.last_status.status == 2 %}
                text-gray-600 bg-gray-100
                {% elif project.last_status.status == 4 %}
                text-blue-800 bg-blue-100
                {% elif project.last_status.status == 5 %}
                text-green-800 bg-green-100
                {% elif project.last_status.status == 3 %}
                text-red-800 bg-red-100
                {% endif %}
                ">
                  {{ project.last_status.status_name }}
                </span>
              </td>
              <td class="px-6 py-4 ">
              {{ project.comments.count }}
              </td>

              <td class="px-6 py-4 text-sm font-medium text-right whitespace-nowrap">
                <a href="{% url 'project' project.id %}" class="text-teal-600 hover:text-teal-900">View</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>

        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}

